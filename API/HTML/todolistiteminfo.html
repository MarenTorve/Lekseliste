<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=150, initial-scale=1.5, user-scalable=no">
  <title>Lekseliste</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <script src="/JavaScript/lib.js"></script>
  <script src="/JavaScript/libModal.js"></script>
  <script src="/JavaScript/libMenu.js"></script>
</head>
<body>
<div id="divMenu"></div>
<h2>Lekseinformasjon: </h2>
<div class="container">
<table>
  <tr>
    <td>
      <label for="txtCaption">Beskrivelse: </label>
    </td>
    <td>
      <input type="text" id="txtCaption">
    </td>
  </tr>
  <tr>
    <td>
      <label for="dtpCreate">Opprettet:</label>
    </td>
    <td>
      <input type="datetime-local" id="dtpCreate">
    </td>
  </tr>
  <tr>
    <td>
      <label for="dtpDue">Frist:</label>
    </td>
    <td>
      <input type="datetime-local" id="dtpDue">
    </td>
  </tr>
<tr>
  <td>
    <label for="dtpDone">Ferdig:</label>
  </td>
  <td>
    <input type="datetime-local" id="dtpDone">
  </td>
</tr>
  <tr>
    <td colspan="2">
      <button>Lagre!</button>
    </td>
  </tr>

</table>
</div>


<script>

  const token = localStorage.getItem('token');
  const fdListItemID = localStorage.getItem('fdListItemID');
  const fdToDoListID = localStorage.getItem('fdToDoListID');
  const fdUserID = localStorage.getItem('fdUserID');
  let txtCaption;
  let dtpCreate;
  let dtpDue;
  let dtpDone;

  window.onload = function(){
    txtCaption = document.getElementById("txtCaption");
    dtpCreate = document.getElementById("dtpCreate");
    dtpDue = document.getElementById("dtpDue");
    dtpDone = document.getElementById("dtpDone");
    menu.addMenuItem(new TMenuItem("Mine lister",navHome));
    menu.addMenuItem(new TMenuItem("Mine lekser",function(){
      const item = {
        fdListItemID: fdListItemID,
        fdToDoListID: fdToDoListID,
        fdUserID:  fdUserID
      };
      navListItem(item);

    }));
    menu.addMenuItem(new TMenuItem("Min side", navUserPage));
    menu.addMenuItem(new TMenuItem("Logg ut", logout));
    document.getElementById("divMenu").appendChild(menu.asHTMLElement());
    getListItemInfoFromServer().then();
  };

  async function getListItemInfoFromServer() {
    const data = {
      token: token,
      fdListItemID: fdListItemID,
      fdToDoListID: fdToDoListID,
      fdUserID: fdUserID
    };

    const route = "/todolist/listitem/readiteminfo";
    const result = await restAPI(RestAPIMethod.POST, route, data);
    if(Array.isArray(result) === true) {
      let tempDate;
      txtCaption.value = result[0].fdCaption;
      tempDate = new Date(result[0].fdDateCreate);
      dtpCreate.value = formatDateToHTML(tempDate);
      tempDate = new Date(result[0].fdDateDue);
      dtpDue.value = formatDateToHTML(tempDate);
      if(result[0].fdDateDone !== null){
        tempDate = new Date(result[0].fdDateDone);
        dtpDone.value = formatDateToHTML(tempDate);
      }else{
        dtpDone.value = "";
      }
    }
  }

</script>

</body>
</html>